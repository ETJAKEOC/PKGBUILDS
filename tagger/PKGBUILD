pkgname=tagger
pkgver=2025.12.26
pkgrel=420
pkgdesc="An easy-to-use music tag (metadata) editor"
arch=('x86_64')
url="https://github.com/ETJAKEOC"
license=('GPL-3.0-or-later')
depends=('chromaprint' 'dotnet-runtime-10.0' 'ffmpeg' 'webp-pixbuf-loader')
makedepends=('blueprint-compiler' 'dotnet-sdk-10.0' 'git')
conflicts=('nickvision-tagger' 'tagger')
source=(git+${url}/Tagger.git git+https://github.com/NickvisionApps/CakeScripts.git)
sha256sums=('SKIP' 'SKIP')
options=('ccache' 'buildflags' 'lto' 'makeflags' 'strip')

build() {
	cd "$srcdir/Tagger"

	dotnet restore NickvisionTagger.GNOME \
		--disable-parallel

	dotnet publish NickvisionTagger.GNOME \
		-c Release \
		--no-restore \
		--no-self-contained
}

package() {
	cd "$srcdir/Tagger"

	install -d "$pkgdir/usr/lib/tagger"
	cp -r NickvisionTagger.GNOME/bin/Release/net10.0/publish/* \
		"$pkgdir/usr/lib/tagger"

	install -d "$pkgdir/usr/bin"
	ln -s /usr/lib/tagger/org.nickvision.tagger \
		"$pkgdir/usr/bin/$pkgname"
}
