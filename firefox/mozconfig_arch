# API Keys
ac_add_options --with-google-location-service-api-keyfile=${PWD}/google-api-key
ac_add_options --with-google-safebrowsing-api-keyfile=${PWD}/google-api-key

# Application & Branding
export MOZILLA_OFFICIAL=1
mk_add_options MOZ_OBJDIR=${PWD}/obj
ac_add_options --enable-application=browser
ac_add_options --with-branding=browser/branding/nightly
ac_add_options --enable-update-channel=nightly
ac_add_options --with-distribution-id=org.archlinux

# Build & Installation
export RUSTC_OPT_LEVEL=3
mk_add_options MOZ_PARALLEL_BUILD="$(nproc)"
ac_add_options --prefix=/usr
ac_add_options --disable-bootstrap
ac_add_options --disable-install-strip
ac_add_options --disable-tests
ac_add_options --disable-webrtc
ac_add_options --disable-eme
ac_add_options --disable-parental-controls
ac_add_options --enable-release
ac_add_options --enable-hardening
ac_add_options --enable-optimize=3
ac_add_options --enable-rust-simd
ac_add_options --enable-linker=lld
ac_add_options --enable-strip
ac_add_options --enable-lto=full
ac_add_options --enable-pgo
ac_add_options --with-ccache=sccache
ac_add_options --with-wasi-sysroot=/usr/share/wasi-sysroot
ac_add_options --enable-linker=lld
export CFLAGS="-O3 -g0 -march=znver2 -mtune=znver2 -pipe -fomit-frame-pointer -fno-plt -falign-functions=32 -falign-loops=32 -funroll-loops"
export CXXFLAGS="${CFLAGS} -fvisibility-inlines-hidden"
export LDFLAGS="-Wl,-O3 -Wl,--as-needed -Wl,--sort-common -fuse-ld=lld -Wl,--icf=all -Wl,--no-keep-memory"
export RUSTFLAGS="-C target-cpu=znver2 -C opt-level=3 -C link-arg=-fuse-ld=lld -C linker-plugin-lto -C codegen-units=1 -C debuginfo=0 -C strip=debuginfo"

# Add-ons & Extensions
ac_add_options --with-unsigned-addon-scopes=app,system
ac_add_options --allow-addon-sideload

# Audio Support
ac_add_options --enable-alsa
ac_add_options --enable-jack

# Debugging & Testing
ac_add_options --disable-debug
ac_add_options --disable-debug-symbols
ac_add_options --disable-tests

# JIT & Runtime Features
ac_add_options --enable-jit

# Update & Crash Handling
ac_add_options --disable-updater
ac_add_options --disable-crashreporter

# Build English only
mk_add_options MOZ_CO_LOCALES=en_US
ac_add_options --enable-ui-locale=en_US
ac_add_options --disable-default-browser-agent
export MOZ_UI_LOCALE=en-US
